<div class="form-container">
  <h2>{{ isEditMode ? '✏️ Modifier un livre' : '➕ Ajouter un livre' }}</h2>
  
  <form #bookForm="ngForm" (ngSubmit)="onSubmit(bookForm)">
    <!-- Titre -->
    <div class="form-group">
      <label for="title">Titre *</label>
      <input 
        type="text" 
        id="title"
        name="title"
        [(ngModel)]="book.title"
        #title="ngModel"
        required
        minlength="3"
        class="form-control"
        placeholder="Entrez le titre du livre">
      
      @if (title.invalid && title.dirty) {
        <div class="error-message">
          @if (title.errors?.['required']) {
            <span>Le titre est obligatoire</span>
          }
          @if (title.errors?.['minlength']) {
            <span>Le titre doit contenir au moins 3 caractères</span>
          }
        </div>
      }
    </div>

    <!-- Auteur -->
    <div class="form-group">
      <label for="author">Auteur *</label>
      <input 
        type="text" 
        id="author"
        name="author"
        [(ngModel)]="book.author"
        #author="ngModel"
        required
        minlength="3"
        class="form-control"
        placeholder="Nom de l'auteur">
      
      @if (author.invalid && author.dirty) {
        <div class="error-message">
          @if (author.errors?.['required']) {
            <span>L'auteur est obligatoire</span>
          }
          @if (author.errors?.['minlength']) {
            <span>L'auteur doit contenir au moins 3 caractères</span>
          }
        </div>
      }
    </div>

    <!-- Email éditeur -->
    <div class="form-group">
      <label for="publisherEmail">Email éditeur *</label>
      <input 
        type="email" 
        id="publisherEmail"
        name="publisherEmail"
        [(ngModel)]="book.publisherEmail"
        #publisherEmail="ngModel"
        required
        email
        class="form-control"
        placeholder="email@editeur.com">
      
      @if (publisherEmail.invalid && publisherEmail.dirty) {
        <div class="error-message">
          @if (publisherEmail.errors?.['required']) {
            <span>L'email est obligatoire</span>
          }
          @if (publisherEmail.errors?.['email']) {
            <span>Email invalide</span>
          }
        </div>
      }
    </div>

    <!-- Téléphone éditeur -->
    <div class="form-group">
      <label for="publisherPhone">Téléphone éditeur</label>
      <input 
        type="tel" 
        id="publisherPhone"
        name="publisherPhone"
        [(ngModel)]="book.publisherPhone"
        #publisherPhone="ngModel"
        pattern="^[0-9]{8}$"
        class="form-control"
        placeholder="12345678">
      
      @if (publisherPhone.invalid && publisherPhone.dirty) {
        <div class="error-message">
          @if (publisherPhone.errors?.['pattern']) {
            <span>Le téléphone doit contenir exactement 8 chiffres</span>
          }
        </div>
      }
    </div>

    <!-- Date de parution -->
    <div class="form-group">
      <label for="releaseDate">Date de parution *</label>
      <input 
        type="date" 
        id="releaseDate"
        name="releaseDate"
        [(ngModel)]="book.releaseDate"
        #releaseDate="ngModel"
        required
        min="1900-01-01"
        class="form-control">
      
      @if (releaseDate.invalid && releaseDate.dirty) {
        <div class="error-message">
          @if (releaseDate.errors?.['required']) {
            <span>La date est obligatoire</span>
          }
        </div>
      }
    </div>

    <!-- Catégorie -->
    <div class="form-group">
      <label for="category">Catégorie *</label>
      <select 
        id="category"
        name="category"
        [(ngModel)]="book.category"
        #category="ngModel"
        required
        class="form-control">
        <option value="">-- Sélectionnez une catégorie --</option>
        @for (cat of categories; track cat) {
          <option [value]="cat">{{ cat }}</option>
        }
      </select>
      
      @if (category.invalid && category.dirty) {
        <div class="error-message">
          <span>La catégorie est obligatoire</span>
        </div>
      }
    </div>

    <!-- Stock -->
    <div class="form-group">
      <label for="stock">Stock</label>
      <input 
        type="number" 
        id="stock"
        name="stock"
        [(ngModel)]="book.stock"
        #stock="ngModel"
        min="0"
        class="form-control"
        placeholder="Nombre d'exemplaires">
      
      @if (stock.invalid && stock.dirty) {
        <div class="error-message">
          @if (stock.errors?.['min']) {
            <span>Le stock doit être positif ou nul</span>
          }
        </div>
      }
    </div>

    <!-- Disponibilité -->
    <div class="form-group checkbox-group">
      <label>
        <input 
          type="checkbox" 
          id="isAvailable"
          name="isAvailable"
          [(ngModel)]="book.isAvailable">
        <span>Disponible</span>
      </label>
    </div>

    <!-- Boutons -->
    <div class="form-actions">
      <button 
        type="submit" 
        class="btn btn-primary"
        [disabled]="bookForm.invalid">
        {{ isEditMode ? '✓ Mettre à jour' : '+ Ajouter' }}
      </button>
      
      @if (isEditMode) {
        <button 
          type="button" 
          class="btn btn-secondary"
          (click)="onCancel(bookForm)">
          ✕ Annuler
        </button>
      }
    </div>
  </form>
</div>
